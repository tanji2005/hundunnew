# hundunnew ğŸ§­âš™ï¸

å—é©±é˜»å°¼æ‘†çš„ä¸¤ç§æ•°å€¼ç§¯åˆ†æ–¹æ¡ˆä¸å¯¹æ¯”åˆ†æã€‚

## âœ¨ é¡¹ç›®ç®€ä»‹
- å®ç°ä¸¤ç§å¸¸ç”¨æ•°å€¼æ–¹æ³•ï¼Œå¹¶åœ¨ç›¸åŒæ—¶é—´ç½‘æ ¼ä¸Šè¿›è¡Œå¯¹æ¯”ï¼Œæ”¯æŒå›¾å½¢åŒ–å±•ç¤ºï¼š
  - `strang/`ï¼šStrang åˆ†è£‚ï¼ˆL(h/2) â†’ N(h) â†’ L(h/2)ï¼‰ã€‚N ç”¨ Velocity-Verletï¼ˆè¾›ï¼‰ï¼ŒL ç”¨ `solve_ivp` çš„ RK45ã€‚
  - `full/`ï¼šä¼ ç»Ÿå…¨æ–¹ç¨‹æ•°å€¼è§£ï¼ˆ`solve_ivp` æˆ– `odeint`ï¼‰ã€‚
  - `compare/`ï¼šå¯¹æ¯”ä¸¤æ–¹æ¡ˆï¼Œè¾“å‡ºè¯¯å·®æŒ‡æ ‡å¹¶ç»˜åˆ¶è¦†ç›–å›¾ã€å·®å¼‚æ›²çº¿å’Œç›¸å›¾ã€‚

## ğŸ§  æ•°å­¦æ¨¡å‹
- å˜é‡ï¼š`x = Î¸`ï¼Œ`v = dÎ¸/dt`ã€‚
- æ–¹ç¨‹ï¼š
  - `dx/dt = v`
  - `dv/dt = (m g r / J) sin x - 2 b v - (k/J) x + (k/J) Î¸0 cos(Ï‰ t + Ï†)`
- é»˜è®¤å‚æ•°ï¼š`J=0.0025, m=0.044279, g=9.8, r=0.1, b=0.006062, k=0.0356, Î¸0=0.09, Ï‰=1.1775, Ï†=0`ã€‚

## ğŸ“¦ ç›®å½•ç»“æ„
```
.
â”œâ”€â”€ strang/           # Strang åˆ†è£‚æ³•ï¼ˆL åŠæ­¥ + N æ•´æ­¥ + L åŠæ­¥ï¼‰
â”‚   â”œâ”€â”€ core.py
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ full/             # ä¼ ç»Ÿå…¨æ–¹ç¨‹æ±‚è§£ï¼ˆsolve_ivp / odeintï¼‰
â”‚   â”œâ”€â”€ core.py
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ compare/          # å¯¹æ¯”ä¸¤æ–¹æ¡ˆå¹¶ç»˜å›¾
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ REPORT.md         # è‹¥å¹²å®éªŒçš„æŒ‡æ ‡ä¸å›¾åƒè·¯å¾„
â”œâ”€â”€ README.md         # æœ¬æ–‡æ¡£
â”œâ”€â”€ LICENSE           # è®¸å¯åè®®ï¼ˆMITï¼‰
â””â”€â”€ .gitignore
```

## ğŸš€ å¿«é€Ÿå¼€å§‹
1) æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–ï¼š
- `source .venv/bin/activate`
- `pip install -U pip`
- `pip install numpy scipy matplotlib`

2) è¿è¡Œ Strang åˆ†è£‚å¹¶ç»˜å›¾ï¼š
- `python -m strang.main --tf 50 --h 1e-3 --plot --outdir figs`

3) è¿è¡Œå…¨æ–¹ç¨‹ï¼ˆRK45 æˆ– odeintï¼‰å¹¶ç»˜å›¾ï¼š
- `python -m full.main --tf 50 --h 1e-3 --method solve_ivp --plot --outdir figs`
- `python -m full.main --tf 50 --h 1e-3 --method odeint   --plot --outdir figs`

4) å¯¹æ¯”ä¸¤è€…ï¼ˆåŒä¸€æ—¶é—´ç½‘æ ¼ï¼‰ï¼š
- `python -m compare.main --tf 50 --h 1e-3 --full-method solve_ivp --plot --outdir figs --export compare_solveivp.npz`

## ğŸ“Š è¾“å‡ºä¸å›¾åƒ
- æŒ‡æ ‡ï¼šåœ¨æ§åˆ¶å°è¾“å‡º `|dx|_max, |dv|_max, RMS(dx), RMS(dv)`ã€‚
- å›¾åƒï¼šç”Ÿæˆ `x(t)` è¦†ç›–å›¾ã€`v(t)` è¦†ç›–å›¾ã€å·®å€¼ `dx(t)`ã€ç›¸å›¾è¦†ç›–ï¼Œä¾¿äºç›´è§‚æ¯”è¾ƒã€‚

### ğŸ–¼ï¸ ç¤ºä¾‹å›¾ï¼ˆ200s, h=5e-3, solve_ivp å¯¹æ¯”ï¼‰
![Strang ç›¸å›¾ä¸æ—¶åº](assets/strang.png)

![Full ç›¸å›¾ä¸æ—¶åºï¼ˆsolve_ivpï¼‰](assets/full_solve_ivp.png)

![å¯¹æ¯”ä¸å·®å¼‚å›¾](assets/compare_solve_ivp.png)

## ğŸ”§ å‚æ•°å»ºè®®
- é€‰æ‹© `h << 2Ï€/Ï‰`ï¼ˆçº¦ 5.34ï¼‰ä»¥ä¿è¯ç²¾åº¦ä¸ç¨³å®šæ€§ã€‚
- ç³»ç»Ÿå«é©±åŠ¨ä¸é˜»å°¼ï¼Œæ€»èƒ½é‡ä¸å®ˆæ’ï¼›ç›¸å›¾ï¼ˆx-vï¼‰æ›´ç›´è§‚åœ°åæ˜ é•¿æœŸè¡Œä¸ºã€‚

## ğŸ“š æ–¹æ³•åŸç†ä¸è¯æ˜

### 1) æ•°å­¦åŸç†è¯´æ˜

### é—®é¢˜è®¾å®š

æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰çš„åˆå€¼é—®é¢˜ï¼š
$$\frac{d\mathbf{y}}{dt} = F(\mathbf{y}, t) = (A + B)\,\mathbf{y}, \quad \mathbf{y}(t_0) = \mathbf{y}_0$$
å…¶ä¸­ $A$ å’Œ $B$ æ˜¯ç®—å­ï¼Œå¯ä»¥ä»£è¡¨çº¿æ€§æˆ–éçº¿æ€§çš„ä½œç”¨ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼š
- **ç®—å­ A** å¯¹åº”â€œçº¿æ€§ + è€—æ•£ + å¤–åŠ›é©±åŠ¨â€éƒ¨åˆ†ã€‚
- **ç®—å­ B** å¯¹åº”â€œéçº¿æ€§ä¿å®ˆï¼ˆå“ˆå¯†é¡¿ï¼‰â€éƒ¨åˆ†ã€‚

### è§£ç®—å­ (Solution Operator)

ä»æ—¶é—´ $t$ æ¼”åŒ–åˆ° $t+h$ çš„ç²¾ç¡®è§£ç®—å­è®°ä¸º $\Phi_{h}^{A+B}$ï¼š
$$\mathbf{y}(t+h) = \Phi_{h}^{A+B}(\mathbf{y}(t)) = e^{h(A+B)}\,\mathbf{y}(t)$$
åŒç†ï¼Œå¯¹äºå­é—®é¢˜ $\dot{\mathbf{y}}=A\mathbf{y}$ ä¸ $\dot{\mathbf{y}}=B\mathbf{y}$ï¼Œå®ƒä»¬çš„è§£ç®—å­åˆ†åˆ«ä¸º $\Phi_{h}^{A}=e^{hA}$ å’Œ $\Phi_{h}^{B}=e^{hB}$ã€‚

### ç®—å­åˆ†è£‚æ³•çš„æ ¸å¿ƒæ€æƒ³

ç›´æ¥è®¡ç®— $\Phi_{h}^{A+B}$ é€šå¸¸å¾ˆå›°éš¾ã€‚ç®—å­åˆ†è£‚æ³•é€šè¿‡ç»„åˆ $\Phi_{h}^{A}$ ä¸ $\Phi_{h}^{B}$ æ¥è¿‘ä¼¼æ±‚è§£ã€‚

- **ä¸€é˜¶ Lieâ€“Trotter åˆ†è£‚**ï¼š
  $$
  \Phi_h^{A+B} \approx \Phi_h^A\,\Phi_h^B
  $$
  å…¶å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º $O(h^2)$ï¼Œå…¨å±€è¯¯å·®ä¸º $O(h)$ã€‚

- **äºŒé˜¶ Strang åˆ†è£‚**ï¼š
  $$
  \Psi_h^{\mathrm{Strang}} = \Phi_{h/2}^A\,\Phi_h^B\,\Phi_{h/2}^A
  $$
  è¿™ä¸ªè¿‡ç¨‹å¯ä»¥æè¿°ä¸ºâ€œ$A$ æ¼”åŒ–åŠæ­¥ â†’ $B$ æ¼”åŒ–æ•´æ­¥ â†’ $A$ æ¼”åŒ–åŠæ­¥â€ã€‚å…¶å¯¹ç§°çš„ç»“æ„æ˜¯è·å¾—æ›´é«˜ç²¾åº¦çš„å…³é”®ã€‚

åœ¨æ‚¨çš„é¡¹ç›®ä¸­ï¼Œæ‰€é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ï¼š
- **$B$ éƒ¨åˆ†** (éçº¿æ€§ä¿å®ˆ) ä½¿ç”¨ Velocity-Verlet (ä¸€ç§è¾›ç§¯åˆ†å™¨) æ¼”åŒ–ä¸€ä¸ª**æ•´æ­¥** `h`ã€‚
- **$A$ éƒ¨åˆ†** (çº¿æ€§è€—æ•£+å¤–é©±) ä½¿ç”¨ `solve_ivp` ä¸­çš„ RK45 æ–¹æ³•æ¼”åŒ–ä¸€ä¸ª**åŠæ­¥** `h/2`ã€‚
- æœ€ç»ˆç»„åˆæˆ Strang åˆ†è£‚æ ¼å¼ï¼š`L(h/2) â†’ N(h) â†’ L(h/2)`ã€‚

### ç²¾åº¦é˜¶æ•°è¯æ˜ï¼ˆäºŒé˜¶ï¼‰

**ç›®æ ‡**ï¼šè¯æ˜ Strang åˆ†è£‚çš„å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º $O(h^3)$ï¼Œä»è€Œç¡®ä¿å…¶å…¨å±€è¯¯å·®ä¸ºäºŒé˜¶ $O(h^2)$ã€‚

**å…³é”®å·¥å…·**ï¼šBakerâ€“Campbellâ€“Hausdorff (BCH) å…¬å¼ã€‚å¯¹äºä¸¤ä¸ªéäº¤æ¢ç®—å­ $X$ å’Œ $Y$ï¼š
$$e^X e^Y = e^{Z}$$
å…¶ä¸­ $Z$ å±•å¼€ä¸ºï¼š
$$Z = X+Y + \frac{1}{2}[X,Y] + \frac{1}{12}[X,[X,Y]] - \frac{1}{12}[Y,[X,Y]] + \cdots$$
å½“ $X$ å’Œ $Y$ éƒ½æ˜¯ $O(h)$ æ—¶ï¼Œå–å¯¹æ•°å¯å¾—ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„è¿‘ä¼¼ï¼š
$$\log(e^X e^Y) = X + Y + \frac{1}{2}[X,Y] + O(h^3)$$

**è¯æ˜æ€è·¯**ï¼š
æˆ‘ä»¬å°† Strang åˆ†è£‚ç®—å­ $\Psi_h^{\mathrm{Strang}}=e^{\frac{h}{2}A}e^{hB}e^{\frac{h}{2}A}$ å†™æˆå•ä¸€æŒ‡æ•° $e^Z$ çš„å½¢å¼ï¼Œç„¶åå°†å…¶ä¸ç²¾ç¡®è§£çš„ç®—å­ $e^{h(A+B)}$ è¿›è¡Œæ¯”è¾ƒã€‚

1.  **é¦–å…ˆåˆå¹¶åä¸¤é¡¹**
    ä»¤ $X = hB$, $Y = \frac{h}{2}A$ã€‚æ ¹æ® BCH å…¬å¼ï¼š
    $$
    \begin{align*}
    \log\left(e^{hB} e^{\frac{h}{2}A}\right) &= (hB) + \left(\frac{h}{2}A\right) + \frac{1}{2}\left[hB, \frac{h}{2}A\right] + O(h^3) \\
    &= hB + \frac{h}{2}A + \frac{h^2}{4}[B,A] + O(h^3)
    \end{align*}
    $$
    æˆ‘ä»¬è®°æ­¤ç»“æœä¸ºç®—å­ $C$ï¼Œå³ $e^C = e^{hB} e^{\frac{h}{2}A}$ã€‚

2.  **å†ä¸ç¬¬ä¸€é¡¹åˆå¹¶**
    ç°åœ¨æˆ‘ä»¬è®¡ç®— $\Psi_h^{\mathrm{Strang}}=e^{\frac{h}{2}A} e^C$ã€‚ä»¤ $X=\frac{h}{2}A$, $Y=C$ï¼š
    $$
    \log(\Psi_h^{\mathrm{Strang}}) = \left(\frac{h}{2}A\right) + C + \frac{1}{2}\left[\frac{h}{2}A, C\right] + O(h^3)
    $$

### 3) ä»£å…¥ C å¹¶æŒ‰ h çš„å¹‚æ¬¡æ”¶é›†é¡¹

é¦–å…ˆï¼Œå°†ç®—å­ $C$ çš„è¡¨è¾¾å¼ä»£å…¥åˆ° $\log(\Psi_h^{\mathrm{Strang}})$ çš„å…¬å¼ä¸­ï¼š
$$\log(\Psi_h^{\mathrm{Strang}}) = \frac{h}{2}A + C + \frac{1}{2}\left[\frac{h}{2}A, C\right] + O(h^3)$$
ä»£å…¥ $C = hB + \frac{h}{2}A + \frac{h^2}{4}[B,A] + O(h^3)$ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
$$\log(\Psi_h^{\mathrm{Strang}}) = \frac{h}{2}A + \left( hB + \frac{h}{2}A + \frac{h^2}{4}[B,A] \right) + \frac{1}{2}\left[\frac{h}{2}A, hB + \frac{h}{2}A + \dots\right] + O(h^3)$$
ç°åœ¨ï¼Œæˆ‘ä»¬æŒ‰ $h$ çš„å¹‚æ¬¡æ¥æ•´ç†å’Œåˆ†æå„é¡¹ã€‚

- #### $O(h)$ é˜¶é¡¹
  åªçœ‹ä¸ $h$ æˆæ­£æ¯”çš„é¡¹ï¼š
  $$
  \frac{h}{2}A + hB + \frac{h}{2}A = h(A+B)
  $$
  è¿™ä¸ç²¾ç¡®è§£ç®—å­ $e^{h(A+B)}$ çš„æŒ‡æ•°ä¸­çš„ä¸€é˜¶é¡¹å®Œå…¨ä¸€è‡´ã€‚

- #### $O(h^2)$ é˜¶é¡¹
  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ”¶é›†æ‰€æœ‰ä¸ $h^2$ æˆæ­£æ¯”çš„é¡¹ã€‚è¿™äº›é¡¹æ¥è‡ªä¸¤ä¸ªåœ°æ–¹ï¼š
  1.  æ¥è‡ª $C$ è¡¨è¾¾å¼ä¸­çš„é¡¹ï¼š$\frac{h^2}{4}[B,A]$
  2.  æ¥è‡ªå¯¹æ˜“å­ $\frac{1}{2}\left[\frac{h}{2}A, C\right]$ã€‚æˆ‘ä»¬åªéœ€è€ƒè™‘ $C$ ä¸­çš„æœ€ä½é˜¶é¡¹ï¼ˆ$hB$ï¼‰ï¼Œå› ä¸ºå…¶ä»–é¡¹ä¼šäº§ç”Ÿæ›´é«˜é˜¶çš„è´¡çŒ®ï¼ˆ$O(h^3)$ æˆ–æ›´é«˜ï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ä¸»è¦è´¡çŒ®æ˜¯ï¼š
      $$
      \frac{1}{2}\left[\frac{h}{2}A, hB\right] = \frac{h^2}{4}[A,B]
      $$
  å°†è¿™ä¸¤ä¸ª $O(h^2)$ çš„é¡¹ç›¸åŠ ï¼š
  $$
  \frac{h^2}{4}[B,A] + \frac{h^2}{4}[A,B]
  $$
  åˆ©ç”¨å¯¹æ˜“å­çš„åå¯¹ç§°æ€§è´¨ $[A,B] = -[B,A]$ï¼Œä¸Šå¼å˜ä¸ºï¼š
  $$
  \frac{h^2}{4}(- [A,B] + [A,B]) = 0
  $$
  å¯è§ï¼Œ$O(h^2)$ é˜¶çš„è¯¯å·®é¡¹è¢«å®Œå…¨æŠµæ¶ˆäº†ã€‚

### ç»“è®º

ç”±äº $O(h^2)$ é¡¹ä¸ºé›¶ï¼Œ$\log(\Psi_h^{\mathrm{Strang}})$ çš„å±•å¼€å¼ä¸ $h(A+B)$ çš„å·®å¼‚ä» $O(h^3)$ é˜¶æ‰å¼€å§‹å‡ºç°ï¼š
$$\log(\Psi_h^{\mathrm{Strang}}) = h(A+B) + O(h^3)$$
è¿™æ„å‘³ç€ Strang åˆ†è£‚ç®—å­ä¸ç²¾ç¡®è§£ç®—å­ä¹‹å·®ä¸º $O(h^3)$ï¼š
$$\Psi_h^{\mathrm{Strang}} = e^{h(A+B)} + O(h^3)$$
å› æ­¤ï¼Œè¯¥æ–¹æ³•çš„**å±€éƒ¨æˆªæ–­è¯¯å·®**ä¸º $O(h^3)$ï¼Œ**å…¨å±€è¯¯å·®**ä¸º $O(h^2)$ã€‚è¯æ¯•ã€‚


**è¯æ¯•ã€‚**

### 3) ç¨³å®šæ€§ä¸å¯è¡Œæ€§åˆ†æ

#### å¯è¡Œæ€§ï¼ˆFeasibilityï¼‰
åˆ†è£‚æ³•å¯è¡Œæ€§çš„å…³é”®åœ¨äºâ€œå­é—®é¢˜æ˜¯å¦æ›´æ˜“æ±‚â€ï¼š

1) $B$ï¼ˆéçº¿æ€§ä¿å®ˆï¼‰ï¼šä¸ºå“ˆå¯†é¡¿å­ç³»ç»Ÿï¼Œå¯ç”¨è¾›ç§¯åˆ†å™¨ï¼ˆå¦‚ Velocity-Verletï¼‰é«˜æ•ˆç¨³å®šåœ°æ•´æ­¥æ›´æ–°ï¼›
2) $A$ï¼ˆçº¿æ€§è€—æ•£+å¤–é©±ï¼‰ï¼šçº¿æ€§ç³»ç»Ÿï¼Œå¯è§£ææˆ–é«˜æ•ˆæ•°å€¼æ¨è¿›ã€‚ä½¿ç”¨ RK45 åŠæ­¥å³å¯è¾¾åˆ°æ‰€éœ€ç²¾åº¦ã€‚

#### ç¨³å®šæ€§ï¼ˆStabilityï¼‰

- ç»§æ‰¿å­æ³•ç¨³å®šæ€§ï¼š
  - $B$ ç”¨çš„ Velocity-Verlet åœ¨çº¿æ€§æµ‹è¯•æ–¹ç¨‹ä¸‹æ— æ¡ä»¶ç¨³å®šï¼Œä¸”ä¿æŒè¾›ç»“æ„ï¼Œé•¿æœŸæŠ‘åˆ¶èƒ½é‡è™šå‡æ¼‚ç§»ï¼›
  - $A$ ä¸ºé˜»å°¼å‹ï¼Œæ•°å€¼ä¸Šè‡ªå¸¦ç¨³å®šåŒ–ï¼›åœ¨åˆç†æ­¥é•¿ä¸‹ RK45 ç¨³å®šã€‚
- ç»“æ„ä¿æŒä¼˜åŠ¿ï¼šé©±åŠ¨+é˜»å°¼ç ´åä¿å®ˆæ€§ï¼Œä½†å¯¹ $B$ ä½¿ç”¨è¾›æ–¹æ³•èƒ½â€œè®°ä½â€ç³»ç»Ÿçš„å‡ ä½•ç»“æ„ï¼›åœ¨å¼±è€—æ•£/é©±åŠ¨ä¸‹ï¼Œç›¸æ¯”å¯¹æ•´ç³»ç»Ÿç›´æ¥ç”¨å¸¸è§„æ–¹æ³•ï¼Œé•¿æœŸè¡¨ç°æ›´ç¨³å¥ã€‚

ç»¼ä¸Šï¼ŒStrang åˆ†è£‚é€šè¿‡â€œå¯¹ä¿å®ˆéª¨æ¶ç”¨è¾›æ³•ã€å¯¹è€—æ•£é©±åŠ¨ç”¨æ ‡å‡†æ³•â€çš„æ­é…ï¼Œå®ç°äº†ç²¾åº¦ä¸é•¿æœŸç¨³å®šæ€§çš„å¹³è¡¡ï¼Œå› è€Œåœ¨è®¡ç®—ç‰©ç†/åŒ–å­¦ä¸­è¢«å¹¿æ³›é‡‡ç”¨ã€‚

## ğŸ“ è®¸å¯
- æœ¬é¡¹ç›®ä½¿ç”¨ MIT Licenseï¼Œè¯¦è§ `LICENSE` æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®
- æ¬¢è¿æäº¤ Issue/PRï¼Œæˆ–æå‡ºæ–°ç‰¹æ€§å»ºè®®ï¼ˆå¦‚è§£æçº¿æ€§åŠæ­¥ã€PoincarÃ© æˆªé¢ã€æ‰¹é‡å¯¹æ¯”æŠ¥å‘Šç­‰ï¼‰ã€‚
